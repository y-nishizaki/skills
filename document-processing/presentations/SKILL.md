---
name: pptx
description: "プレゼンテーション作成・編集・分析。Claudeがプレゼンテーション(.pptxファイル)を扱う必要がある場合に使用：(1) 新規プレゼンテーション作成、(2) コンテンツの変更・編集、(3) レイアウト操作、(4) コメントやスピーカーノートの追加、その他プレゼンテーション関連のタスク"
license: Proprietary. LICENSE.txt has complete terms
---

# PPTXの作成・編集・分析

## 概要

ユーザーは.pptxファイルの作成、編集、内容の分析を依頼することがあります。.pptxファイルは本質的にXMLファイルやその他のリソースを含むZIPアーカイブで、読み取りや編集が可能です。タスクに応じて異なるツールとワークフローが利用できます。

## コンテンツの読み取りと分析

### テキスト抽出
プレゼンテーションのテキスト内容のみを読み取る場合は、ドキュメントをMarkdownに変換してください：

```bash
# ドキュメントをMarkdownに変換
python -m markitdown path-to-file.pptx
```

### 生XMLアクセス
次の要素にアクセスする場合は生XMLアクセスが必要です：コメント、スピーカーノート、スライドレイアウト、アニメーション、デザイン要素、複雑な書式設定。これらの機能には、プレゼンテーションを解凍して生XMLの内容を読み取る必要があります。

#### ファイルの解凍
`python ooxml/scripts/unpack.py <office_file> <output_dir>`

**注意**: unpack.pyスクリプトはプロジェクトルートからの相対パスで`skills/pptx/ooxml/scripts/unpack.py`にあります。このパスにスクリプトが存在しない場合は、`find . -name "unpack.py"`を使用して場所を特定してください。

#### 主要なファイル構造
* `ppt/presentation.xml` - メインのプレゼンテーションメタデータとスライド参照
* `ppt/slides/slide{N}.xml` - 個別のスライド内容（slide1.xml、slide2.xmlなど）
* `ppt/notesSlides/notesSlide{N}.xml` - 各スライドのスピーカーノート
* `ppt/comments/modernComment_*.xml` - 特定スライドのコメント
* `ppt/slideLayouts/` - スライドのレイアウトテンプレート
* `ppt/slideMasters/` - マスタースライドテンプレート
* `ppt/theme/` - テーマとスタイル情報
* `ppt/media/` - 画像およびその他のメディアファイル

#### タイポグラフィとカラーの抽出
**模倣すべきデザイン例が与えられた場合**: 常に以下の方法でプレゼンテーションのタイポグラフィと色を最初に分析してください：
1. **テーマファイルを読む**: `ppt/theme/theme1.xml`で色（`<a:clrScheme>`）とフォント（`<a:fontScheme>`）を確認
2. **スライドコンテンツをサンプリング**: `ppt/slides/slide1.xml`で実際のフォント使用（`<a:rPr>`）と色を調査
3. **パターンを検索**: grepを使用してすべてのXMLファイル全体で色（`<a:solidFill>`、`<a:srgbClr>`）とフォント参照を検索

## テンプレートなしで新しいPowerPointプレゼンテーションを作成

最初から新しいPowerPointプレゼンテーションを作成する場合は、**html2pptx**ワークフローを使用して、HTMLスライドを正確な配置でPowerPointに変換します。

### デザイン原則

**重要**: プレゼンテーションを作成する前に、コンテンツを分析して適切なデザイン要素を選択してください：
1. **主題を考慮**: このプレゼンテーションは何についてですか？どのようなトーン、業界、雰囲気を示唆していますか？
2. **ブランディングを確認**: ユーザーが会社や組織に言及している場合は、そのブランドカラーとアイデンティティを考慮してください
3. **パレットをコンテンツに合わせる**: 主題を反映する色を選択してください
4. **アプローチを述べる**: コードを書く前にデザインの選択を説明してください

**要件**:
- ✅ コードを書く前に、コンテンツに基づいたデザインアプローチを述べてください
- ✅ Webセーフフォントのみ使用: Arial、Helvetica、Times New Roman、Georgia、Courier New、Verdana、Tahoma、Trebuchet MS、Impact
- ✅ サイズ、ウェイト、色を通じて明確な視覚的階層を作成してください
- ✅ 読みやすさを確保: 強いコントラスト、適切なサイズのテキスト、きれいな配置
- ✅ 一貫性を保つ: パターン、間隔、視覚言語をスライド全体で繰り返してください

#### カラーパレットの選択

**創造的な色の選択**:
- **デフォルトを超えて考える**: この特定のトピックに本当に合う色は何ですか？自動操縦の選択を避けてください。
- **複数の角度を考慮**: トピック、業界、雰囲気、エネルギーレベル、ターゲットオーディエンス、ブランドアイデンティティ（言及されている場合）
- **冒険的に**: 予想外の組み合わせを試してください - ヘルスケアのプレゼンテーションが緑である必要はなく、ファイナンスが紺色である必要もありません
- **パレットを構築**: 一緒に機能する3〜5色を選択（主要色 + サポートトーン + アクセント）
- **コントラストを確保**: テキストは背景に対して明確に読めなければなりません

**カラーパレットの例**（創造性を刺激するために使用 - 1つを選択、適応、または独自のものを作成）：

1. **クラシックブルー**: 深い紺色（#1C2833）、スレートグレー（#2E4053）、シルバー（#AAB7B8）、オフホワイト（#F4F6F6）
2. **ティール＆コーラル**: ティール（#5EA8A7）、ディープティール（#277884）、コーラル（#FE4447）、ホワイト（#FFFFFF）
3. **ボールドレッド**: 赤（#C0392B）、明るい赤（#E74C3C）、オレンジ（#F39C12）、黄色（#F1C40F）、緑（#2ECC71）
4. **ウォームブラッシュ**: モーブ（#A49393）、ブラッシュ（#EED6D3）、ローズ（#E8B4B8）、クリーム（#FAF7F2）
5. **バーガンディラグジュアリー**: バーガンディ（#5D1D2E）、クリムゾン（#951233）、錆（#C15937）、ゴールド（#997929）
6. **ディープパープル＆エメラルド**: パープル（#B165FB）、ダークブルー（#181B24）、エメラルド（#40695B）、ホワイト（#FFFFFF）
7. **クリーム＆フォレストグリーン**: クリーム（#FFE1C7）、フォレストグリーン（#40695B）、ホワイト（#FCFCFC）
8. **ピンク＆パープル**: ピンク（#F8275B）、コーラル（#FF574A）、ローズ（#FF737D）、パープル（#3D2F68）
9. **ライム＆プラム**: ライム（#C5DE82）、プラム（#7C3A5F）、コーラル（#FD8C6E）、ブルーグレー（#98ACB5）
10. **ブラック＆ゴールド**: ゴールド（#BF9A4A）、ブラック（#000000）、クリーム（#F4F6F6）
11. **セージ＆テラコッタ**: セージ（#87A96B）、テラコッタ（#E07A5F）、クリーム（#F4F1DE）、チャコール（#2C2C2C）
12. **チャコール＆レッド**: チャコール（#292929）、赤（#E33737）、ライトグレー（#CCCBCB）
13. **ビブラントオレンジ**: オレンジ（#F96D00）、ライトグレー（#F2F2F2）、チャコール（#222831）
14. **フォレストグリーン**: ブラック（#191A19）、グリーン（#4E9F3D）、ダークグリーン（#1E5128）、ホワイト（#FFFFFF）
15. **レトロレインボー**: パープル（#722880）、ピンク（#D72D51）、オレンジ（#EB5C18）、アンバー（#F08800）、ゴールド（#DEB600）
16. **ビンテージアーシー**: マスタード（#E3B448）、セージ（#CBD18F）、フォレストグリーン（#3A6B35）、クリーム（#F4F1DE）
17. **コースタルローズ**: オールドローズ（#AD7670）、ビーバー（#B49886）、エッグシェル（#F3ECDC）、アッシュグレー（#BFD5BE）
18. **オレンジ＆ターコイズ**: ライトオレンジ（#FC993E）、グレイッシュターコイズ（#667C6F）、ホワイト（#FCFCFC）

#### ビジュアル詳細オプション

**幾何学的パターン**:
- 水平ではなく斜めのセクション分割
- 非対称カラム幅（30/70、40/60、25/75）
- 90°または270°で回転したテキストヘッダー
- 画像用の円形/六角形フレーム
- コーナーの三角形アクセント形状
- 深さのための重なり合った形状

**ボーダー＆フレーム処理**:
- 片側のみの太い単色ボーダー（10-20pt）
- 対照的な色を持つ二重線ボーダー
- 完全なフレームではなくコーナーブラケット
- L字型ボーダー（上+左または下+右）
- ヘッダーの下の下線アクセント（3-5pt太）

**タイポグラフィ処理**:
- 極端なサイズコントラスト（72pt見出し vs 11pt本文）
- 広い文字間隔の全大文字ヘッダー
- 特大のディスプレイタイプの番号付きセクション
- データ/統計/技術コンテンツのモノスペース（Courier New）
- 密な情報のための縮小フォント（Arial Narrow）
- 強調のためのアウトラインテキスト

**チャート＆データスタイリング**:
- 主要データに単一アクセントカラーを持つモノクロームチャート
- 垂直ではなく水平棒グラフ
- 棒グラフの代わりにドットプロット
- 最小限のグリッドラインまたはなし
- 要素に直接データラベル（凡例なし）
- 主要メトリクスの特大数値

**レイアウトイノベーション**:
- テキストオーバーレイ付きのフルブリード画像
- ナビゲーション/コンテキスト用のサイドバーカラム（20-30%幅）
- モジュラーグリッドシステム（3×3、4×4ブロック）
- Z字型またはF字型のコンテンツフロー
- 色付き形状上の浮遊テキストボックス
- 雑誌スタイルのマルチカラムレイアウト

**背景処理**:
- スライドの40-60%を占める単色ブロック
- グラデーション塗りつぶし（垂直または斜めのみ）
- 分割背景（2色、斜めまたは垂直）
- 端から端までの色帯
- デザイン要素としてのネガティブスペース

### レイアウトのヒント
**チャートやテーブルを含むスライドを作成する場合：**
- **2カラムレイアウト（推奨）**: 全幅にわたるヘッダーを使用し、その下に2つのカラムを配置 - 片方のカラムにテキスト/箇条書き、もう片方にフィーチャーコンテンツ。これにより、バランスが向上し、チャート/テーブルがより読みやすくなります。flexboxを使用して、各コンテンツタイプのスペースを最適化するために不等なカラム幅（例：40%/60%分割）を使用します。
- **フルスライドレイアウト**: 最大の影響と読みやすさのために、フィーチャーコンテンツ（チャート/テーブル）をスライド全体に配置します
- **絶対に垂直にスタックしない**: チャート/テーブルを単一カラムのテキストの下に配置しないでください - これにより、読みやすさとレイアウトの問題が発生します

### ワークフロー
1. **必須 - ファイル全体を読む**: [`html2pptx.md`](html2pptx.md)を最初から最後まで完全に読んでください。**このファイルを読むときに範囲制限を設定しないでください。** プレゼンテーション作成を進める前に、詳細な構文、重要な書式ルール、ベストプラクティスのためにファイル全体の内容を読んでください。
2. 各スライド用に適切な寸法（例：16:9の場合720pt × 405pt）でHTMLファイルを作成
   - すべてのテキストコンテンツに`<p>`、`<h1>`-`<h6>`、`<ul>`、`<ol>`を使用
   - チャート/テーブルが追加されるエリアに`class="placeholder"`を使用（視認性のためにグレー背景でレンダリング）
   - **重要**: Sharpを使用してグラデーションとアイコンを最初にPNG画像としてラスタライズし、HTMLで参照
   - **レイアウト**: チャート/テーブル/画像を含むスライドの場合、読みやすさを向上させるためにフルスライドレイアウトまたは2カラムレイアウトを使用
3. [`html2pptx.js`](scripts/html2pptx.js)ライブラリを使用してHTMLスライドをPowerPointに変換し、プレゼンテーションを保存するJavaScriptファイルを作成して実行
   - `html2pptx()`関数を使用して各HTMLファイルを処理
   - PptxGenJS APIを使用してプレースホルダーエリアにチャートとテーブルを追加
   - `pptx.writeFile()`を使用してプレゼンテーションを保存
4. **ビジュアル検証**: サムネイルを生成してレイアウトの問題を検査
   - サムネイルグリッドを作成: `python scripts/thumbnail.py output.pptx workspace/thumbnails --cols 4`
   - サムネイル画像を読んで次の点を注意深く調査:
     - **テキストの切り取り**: ヘッダーバー、形状、スライドエッジによってテキストが切り取られている
     - **テキストの重複**: テキストが他のテキストや形状と重複している
     - **配置の問題**: コンテンツがスライド境界や他の要素に近すぎる
     - **コントラストの問題**: テキストと背景間の不十分なコントラスト
   - 問題が見つかった場合、HTMLのマージン/間隔/色を調整してプレゼンテーションを再生成
   - すべてのスライドが視覚的に正しくなるまで繰り返す

## 既存のPowerPointプレゼンテーションの編集

既存のPowerPointプレゼンテーションのスライドを編集する場合、生のOffice Open XML（OOXML）形式で作業する必要があります。これには、.pptxファイルを解凍し、XMLコンテンツを編集し、再圧縮することが含まれます。

### ワークフロー
1. **必須 - ファイル全体を読む**: [`ooxml.md`](ooxml.md)（約500行）を最初から最後まで完全に読んでください。**このファイルを読むときに範囲制限を設定しないでください。** プレゼンテーションの編集前にOOXML構造と編集ワークフローの詳細ガイダンスのためにファイル全体の内容を読んでください。
2. プレゼンテーションを解凍: `python ooxml/scripts/unpack.py <office_file> <output_dir>`
3. XMLファイルを編集（主に`ppt/slides/slide{N}.xml`および関連ファイル）
4. **重要**: 各編集の直後に検証し、続行する前に検証エラーを修正: `python ooxml/scripts/validate.py <dir> --original <file>`
5. 最終プレゼンテーションを圧縮: `python ooxml/scripts/pack.py <input_directory> <office_file>`

## テンプレートを使用して新しいPowerPointプレゼンテーションを作成

既存のテンプレートのデザインに従うプレゼンテーションを作成する必要がある場合は、テンプレートスライドを複製して再配置してから、プレースホルダーコンテキストを置き換える必要があります。

### ワークフロー
1. **テンプレートテキストを抽出してビジュアルサムネイルグリッドを作成**:
   * テキストを抽出: `python -m markitdown template.pptx > template-content.md`
   * `template-content.md`を読む: テンプレートプレゼンテーションの内容を理解するためにファイル全体を読んでください。**このファイルを読むときに範囲制限を設定しないでください。**
   * サムネイルグリッドを作成: `python scripts/thumbnail.py template.pptx`
   * 詳細については[サムネイルグリッドの作成](#サムネイルグリッドの作成)セクションを参照

2. **テンプレートを分析してファイルにインベントリを保存**:
   * **ビジュアル分析**: サムネイルグリッドを確認してスライドレイアウト、デザインパターン、ビジュアル構造を理解
   * `template-inventory.md`にテンプレートインベントリファイルを作成して保存:
     ```markdown
     # テンプレートインベントリ分析
     **総スライド数: [count]**
     **重要: スライドは0インデックス（最初のスライド = 0、最後のスライド = count-1）**

     ## [カテゴリ名]
     - スライド0: [利用可能な場合はレイアウトコード] - 説明/目的
     - スライド1: [レイアウトコード] - 説明/目的
     - スライド2: [レイアウトコード] - 説明/目的
     [... すべてのスライドをインデックスと共に個別にリストする必要があります ...]
     ```
   * **サムネイルグリッドを使用**: ビジュアルサムネイルを参照して次を特定:
     - レイアウトパターン（タイトルスライド、コンテンツレイアウト、セクション区切り）
     - 画像プレースホルダーの場所と数
     - スライドグループ全体のデザインの一貫性
     - ビジュアル階層と構造
   * このインベントリファイルは次のステップで適切なテンプレートを選択するために必須です

3. **テンプレートインベントリに基づいてプレゼンテーションアウトラインを作成**:
   * ステップ2から利用可能なテンプレートを確認
   * 最初のスライドにイントロまたはタイトルテンプレートを選択。これは最初のテンプレートの1つである必要があります。
   * 他のスライドには安全なテキストベースのレイアウトを選択
   * **重要: レイアウト構造を実際のコンテンツと一致させる**:
     - 単一カラムレイアウト: 統一されたナラティブまたは単一トピックに使用
     - 2カラムレイアウト: 正確に2つの異なる項目/概念がある場合にのみ使用
     - 3カラムレイアウト: 正確に3つの異なる項目/概念がある場合にのみ使用
     - 画像 + テキストレイアウト: 挿入する実際の画像がある場合にのみ使用
     - 引用レイアウト: 人からの実際の引用（帰属付き）にのみ使用、強調のために使用しない
     - コンテンツよりも多くのプレースホルダーを持つレイアウトは使用しない
     - 2つの項目がある場合、3カラムレイアウトに無理に押し込まない
     - 4つ以上の項目がある場合、複数のスライドに分割するかリスト形式を使用することを検討
   * レイアウトを選択する前に実際のコンテンツピースをカウント
   * 選択したレイアウトの各プレースホルダーが意味のあるコンテンツで埋められることを確認
   * 各コンテンツセクションに**最適な**レイアウトを表す1つのオプションを選択
   * 利用可能なデザインを活用するコンテンツとテンプレートマッピングで`outline.md`を保存
   * テンプレートマッピングの例:
      ```
      # 使用するテンプレートスライド（0ベースインデックス）
      # 警告: インデックスが範囲内であることを確認！73スライドのテンプレートはインデックス0-72を持つ
      # マッピング: アウトラインのスライド番号 -> テンプレートスライドインデックス
      template_mapping = [
          0,   # スライド0を使用（タイトル/カバー）
          34,  # スライド34を使用（B1: タイトルと本文）
          34,  # スライド34を再度使用（2番目のB1の複製）
          50,  # スライド50を使用（E1: 引用）
          54,  # スライド54を使用（F2: クロージング + テキスト）
      ]
      ```

4. **`rearrange.py`を使用してスライドを複製、並べ替え、削除**:
   * `scripts/rearrange.py`スクリプトを使用して、目的の順序でスライドを持つ新しいプレゼンテーションを作成:
     ```bash
     python scripts/rearrange.py template.pptx working.pptx 0,34,34,50,52
     ```
   * スクリプトは繰り返されるスライドの複製、未使用のスライドの削除、並べ替えを自動的に処理
   * スライドインデックスは0ベース（最初のスライドは0、2番目は1など）
   * 同じスライドインデックスを複数回表示してそのスライドを複製可能

5. **`inventory.py`スクリプトを使用してすべてのテキストを抽出**:
   * **インベントリ抽出を実行**:
     ```bash
     python scripts/inventory.py working.pptx text-inventory.json
     ```
   * **text-inventory.jsonを読む**: すべての形状とそのプロパティを理解するためにtext-inventory.jsonファイル全体を読んでください。**このファイルを読むときに範囲制限を設定しないでください。**

   * インベントリJSON構造:
      ```json
        {
          "slide-0": {
            "shape-0": {
              "placeholder_type": "TITLE",  // または非プレースホルダーの場合はnull
              "left": 1.5,                  // インチ単位の位置
              "top": 2.0,
              "width": 7.5,
              "height": 1.2,
              "paragraphs": [
                {
                  "text": "段落テキスト",
                  // オプションプロパティ（非デフォルトの場合のみ含まれる）:
                  "bullet": true,           // 明示的な箇条書きが検出された
                  "level": 0,               // bulletがtrueの場合のみ含まれる
                  "alignment": "CENTER",    // CENTER、RIGHT（LEFTではない）
                  "space_before": 10.0,     // ポイント単位の段落前スペース
                  "space_after": 6.0,       // ポイント単位の段落後スペース
                  "line_spacing": 22.4,     // ポイント単位の行間隔
                  "font_name": "Arial",     // 最初の実行から
                  "font_size": 14.0,        // ポイント単位
                  "bold": true,
                  "italic": false,
                  "underline": false,
                  "color": "FF0000"         // RGB色
                }
              ]
            }
          }
        }
      ```

   * 主な機能:
     - **スライド**: "slide-0"、"slide-1"などとして名前付け
     - **形状**: 視覚的位置（上から下、左から右）で"shape-0"、"shape-1"などとして順序付け
     - **プレースホルダータイプ**: TITLE、CENTER_TITLE、SUBTITLE、BODY、OBJECT、またはnull
     - **デフォルトフォントサイズ**: レイアウトプレースホルダーから抽出されたポイント単位の`default_font_size`（利用可能な場合）
     - **スライド番号はフィルタリング**: SLIDE_NUMBERプレースホルダータイプの形状は自動的にインベントリから除外
     - **箇条書き**: `bullet: true`の場合、`level`は常に含まれる（0の場合でも）
     - **間隔**: ポイント単位の`space_before`、`space_after`、`line_spacing`（設定されている場合のみ含まれる）
     - **色**: RGB用の`color`（例："FF0000"）、テーマカラー用の`theme_color`（例："DARK_1"）
     - **プロパティ**: 非デフォルト値のみが出力に含まれる

6. **置換テキストを生成してJSONファイルにデータを保存**
   前のステップのテキストインベントリに基づいて:
   - **重要**: まず、インベントリに存在する形状を確認 - 実際に存在する形状のみを参照
   - **検証**: replace.pyスクリプトは、置換JSONのすべての形状がインベントリに存在することを検証
     - 存在しない形状を参照すると、利用可能な形状を示すエラーが表示されます
     - 存在しないスライドを参照すると、スライドが存在しないことを示すエラーが表示されます
     - すべての検証エラーはスクリプトが終了する前に一度に表示されます
   - **重要**: replace.pyスクリプトは内部的にinventory.pyを使用してすべてのテキスト形状を識別
   - **自動クリア**: インベントリのすべてのテキスト形状は、"paragraphs"を提供しない限りクリアされます
   - コンテンツが必要な形状に"paragraphs"フィールドを追加（"replacement_paragraphs"ではない）
   - 置換JSONに"paragraphs"がない形状は自動的にテキストがクリアされます
   - 箇条書き付きの段落は自動的に左揃えになります。`"bullet": true`の場合、`alignment`プロパティを設定しないでください
   - プレースホルダーテキストに適切な置換コンテンツを生成
   - 形状サイズを使用して適切なコンテンツ長を決定
   - **重要**: 元のインベントリの段落プロパティを含める - テキストだけを提供しない
   - **重要**: bullet: trueの場合、テキストに箇条書き記号（•、-、*）を含めない - 自動的に追加されます
   - **必須の書式ルール**:
     - ヘッダー/タイトルは通常`"bold": true`である必要があります
     - リスト項目は`"bullet": true, "level": 0`を持つ必要があります（bulletがtrueの場合、levelは必須）
     - 配置プロパティを保持（例：中央揃えテキストの場合は`"alignment": "CENTER"`）
     - デフォルトと異なる場合はフォントプロパティを含める（例：`"font_size": 14.0`、`"font_name": "Lora"`）
     - 色: RGB用に`"color": "FF0000"`またはテーマカラー用に`"theme_color": "DARK_1"`を使用
     - 置換スクリプトは**適切にフォーマットされた段落**を期待し、単なるテキスト文字列ではありません
     - **重複する形状**: より大きなdefault_font_sizeまたはより適切なplaceholder_typeを持つ形状を優先
   - 置換を含む更新されたインベントリを`replacement-text.json`に保存
   - **警告**: 異なるテンプレートレイアウトは異なる形状数を持ちます - 置換を作成する前に常に実際のインベントリを確認してください

   適切な書式を示す段落フィールドの例:
   ```json
   "paragraphs": [
     {
       "text": "新しいプレゼンテーションタイトルテキスト",
       "alignment": "CENTER",
       "bold": true
     },
     {
       "text": "セクションヘッダー",
       "bold": true
     },
     {
       "text": "箇条書き記号なしの最初の箇条書き",
       "bullet": true,
       "level": 0
     },
     {
       "text": "赤色のテキスト",
       "color": "FF0000"
     },
     {
       "text": "テーマカラーのテキスト",
       "theme_color": "DARK_1"
     },
     {
       "text": "特別な書式なしの通常の段落テキスト"
     }
   ]
   ```

   **置換JSONにリストされていない形状は自動的にクリアされます**:
   ```json
   {
     "slide-0": {
       "shape-0": {
         "paragraphs": [...] // この形状は新しいテキストを取得
       }
       // インベントリのshape-1とshape-2は自動的にクリアされます
     }
   }
   ```

   **プレゼンテーションの一般的な書式パターン**:
   - タイトルスライド: 太字テキスト、時々中央揃え
   - スライド内のセクションヘッダー: 太字テキスト
   - 箇条書きリスト: 各項目に`"bullet": true, "level": 0`が必要
   - 本文テキスト: 通常、特別なプロパティは不要
   - 引用: 特別な配置またはフォントプロパティを持つ可能性がある

7. **`replace.py`スクリプトを使用して置換を適用**
   ```bash
   python scripts/replace.py working.pptx replacement-text.json output.pptx
   ```

   スクリプトは次を実行します:
   - 最初にinventory.pyの関数を使用してすべてのテキスト形状のインベントリを抽出
   - 置換JSONのすべての形状がインベントリに存在することを検証
   - インベントリで識別されたすべての形状からテキストをクリア
   - 置換JSONで"paragraphs"が定義された形状にのみ新しいテキストを適用
   - JSONの段落プロパティを適用して書式を保持
   - 箇条書き、配置、フォントプロパティ、色を自動的に処理
   - 更新されたプレゼンテーションを保存

   検証エラーの例:
   ```
   ERROR: Invalid shapes in replacement JSON:
     - Shape 'shape-99' not found on 'slide-0'. Available shapes: shape-0, shape-1, shape-4
     - Slide 'slide-999' not found in inventory
   ```

   ```
   ERROR: Replacement text made overflow worse in these shapes:
     - slide-0/shape-2: overflow worsened by 1.25" (was 0.00", now 1.25")
   ```

## サムネイルグリッドの作成

PowerPointスライドのビジュアルサムネイルグリッドを作成して、迅速な分析と参照を行うには:

```bash
python scripts/thumbnail.py template.pptx [output_prefix]
```

**機能**:
- 作成: `thumbnails.jpg`（または大きなデッキの場合は`thumbnails-1.jpg`、`thumbnails-2.jpg`など）
- デフォルト: 5カラム、グリッドあたり最大30スライド（5×6）
- カスタムプレフィックス: `python scripts/thumbnail.py template.pptx my-grid`
  - 注意: 特定のディレクトリに出力する場合は、出力プレフィックスにパスを含める必要があります（例：`workspace/my-grid`）
- カラムを調整: `--cols 4`（範囲: 3-6、グリッドあたりのスライド数に影響）
- グリッド制限: 3カラム = 12スライド/グリッド、4カラム = 20、5カラム = 30、6カラム = 42
- スライドはゼロインデックス（スライド0、スライド1など）

**使用例**:
- テンプレート分析: スライドレイアウトとデザインパターンを迅速に理解
- コンテンツレビュー: プレゼンテーション全体のビジュアル概要
- ナビゲーション参照: 視覚的外観で特定のスライドを検索
- 品質チェック: すべてのスライドが適切にフォーマットされていることを確認

**例**:
```bash
# 基本的な使用法
python scripts/thumbnail.py presentation.pptx

# オプションを組み合わせる: カスタム名、カラム
python scripts/thumbnail.py template.pptx analysis --cols 4
```

## スライドを画像に変換

PowerPointスライドを視覚的に分析するには、2ステップのプロセスで画像に変換します:

1. **PPTXをPDFに変換**:
   ```bash
   soffice --headless --convert-to pdf template.pptx
   ```

2. **PDFページをJPEG画像に変換**:
   ```bash
   pdftoppm -jpeg -r 150 template.pdf slide
   ```
   これにより`slide-1.jpg`、`slide-2.jpg`などのファイルが作成されます。

オプション:
- `-r 150`: 解像度を150 DPIに設定（品質/サイズのバランスを調整）
- `-jpeg`: JPEG形式で出力（必要に応じてPNGには`-png`を使用）
- `-f N`: 変換する最初のページ（例：`-f 2`でページ2から開始）
- `-l N`: 変換する最後のページ（例：`-l 5`でページ5で停止）
- `slide`: 出力ファイルのプレフィックス

特定の範囲の例:
```bash
pdftoppm -jpeg -r 150 -f 2 -l 5 template.pdf slide  # ページ2-5のみを変換
```

## コードスタイルガイドライン
**重要**: PPTX操作用のコードを生成する場合:
- 簡潔なコードを書く
- 冗長な変数名と冗長な操作を避ける
- 不要なprint文を避ける

## 依存関係

必要な依存関係（すでにインストールされているはずです）:

- **markitdown**: `pip install "markitdown[pptx]"`（プレゼンテーションからのテキスト抽出用）
- **pptxgenjs**: `npm install -g pptxgenjs`（html2pptx経由でのプレゼンテーション作成用）
- **playwright**: `npm install -g playwright`（html2pptxでのHTMLレンダリング用）
- **react-icons**: `npm install -g react-icons react react-dom`（アイコン用）
- **sharp**: `npm install -g sharp`（SVGラスタライズと画像処理用）
- **LibreOffice**: `sudo apt-get install libreoffice`（PDF変換用）
- **Poppler**: `sudo apt-get install poppler-utils`（PDFを画像に変換するpdftoppm用）
- **defusedxml**: `pip install defusedxml`（安全なXML解析用）
