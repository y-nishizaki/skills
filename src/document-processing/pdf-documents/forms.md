# PDFフォーム記入手順

このドキュメントは、プログラムでPDFフォームを完成させるための包括的なワークフローを提供します。プロセスは、PDFに入力可能なフォームフィールドがあるか、視覚的な注釈が必要かを判断することから始まります。

## 初期評価

最初の重要なステップは、`python scripts/check_fillable_fields <file.pdf>` を使用してPDFに入力可能なフォームフィールドが含まれているかを確認することです。この判断により、入力可能フィールドワークフローまたは入力不可能フィールドワークフローのいずれかに進みます。

## 入力可能フィールドワークフロー

入力可能フィールドを持つPDFの場合、プロセスには以下が含まれます：

1. `extract_form_field_info.py` を使用してフィールドメタデータを抽出します。これにより、フィールド識別子、ページ番号、バウンディングボックス、フィールドタイプ（テキスト、チェックボックス、ラジオグループ、または選択）を含むJSONが生成されます

2. 視覚的分析のためにPDFをPNG画像に変換し、各フィールドの目的を理解します

3. フィールドIDと対応する値をマッピングする `field_values.json` ファイルを作成します。値が正しいタイプと一致することを確認します（チェックボックスにはchecked_valueを使用、ラジオグループにはラジオオプション値を使用、など）

4. `fill_fillable_fields.py` を実行して完成したPDFを生成します。スクリプトにはエラーチェックが組み込まれています

## 入力不可能フィールドワークフロー

入力可能フィールドのないPDFの場合、より詳細な4ステップのプロセスが適用されます：

**ステップ1**では、PDFをPNG画像に変換し、すべてのフォームフィールドとテキスト入力エリアを視覚的に識別し、交差しないラベルと入力エリアの個別のバウンディングボックスを決定します。

**ステップ2**では、ページの寸法、フィールドの説明、ラベル/入力のバウンディングボックス、入力テキストの仕様を含む `fields.json` を作成し、色付き矩形でフィールドの位置を示す検証画像を生成します。

**ステップ3**では、`check_bounding_boxes.py` を使用してバウンディングボックスを検証し、続行する前に矩形が適切に配置されていることを確認するために検証画像を視覚的に検査することが必須です。

**ステップ4**では、`fill_pdf_form_with_annotations.py` を適用して、検証されたバウンディングボックスを使用してPDFにテキスト注釈を追加します。
