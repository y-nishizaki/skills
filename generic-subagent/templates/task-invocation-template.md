# サブエージェント呼び出しテンプレート

このファイルは、汎用サブエージェントをTaskツールで呼び出す際の参考テンプレートです。

## 基本的な呼び出し構造

```
Task tool parameters:
- description: "[3-5単語の簡潔な説明]"
- subagent_type: "general-purpose" または "Explore"
- prompt: [サブエージェントプロンプト + タスク詳細]
```

## 完全なプロンプト構造

サブエージェントに渡すプロンプトは以下の構造にします：

```markdown
[generic-subagent-prompt.mdの全内容]

---

## タスク記述

### タスク概要
[タスク名と目的]

### 目的
[何を達成する必要があるか]

### 手順（複雑なタスクの場合）
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

### 期待される成果物
- [成果物1]
- [成果物2]
- [報告形式の指定]

### 制約・注意事項
- [制約1]
- [制約2]

### コンテキスト（必要な場合）
[背景情報や関連情報]
```

## 実装例

### 例1: コードベース探索（Exploreタイプ）

```python
# Taskツールの呼び出し
Task(
  description="APIエンドポイント定義調査",
  subagent_type="Explore",
  prompt=f"""
{generic_subagent_prompt_content}

---

## タスク記述

### タスク概要
APIエンドポイント定義の包括的調査

### 目的
プロジェクト内でAPIエンドポイントがどのように定義され実装されているかを特定してください。

### 手順
1. ルーティング関連のファイルを検索（routes, api, endpoints等のキーワード）
2. HTTPメソッド定義を探す（GET, POST, PUT, DELETE）
3. 使用されているフレームワークやライブラリを特定
4. エンドポイントのパターンと構造を分析

### 期待される成果物
- 発見されたエンドポイント定義ファイルのリスト（完全なパス付き）
- 使用されているフレームワーク/ライブラリの名前とバージョン
- エンドポイントの定義パターンの説明
- 主要なエンドポイントの具体例（3-5個、パスとHTTPメソッド付き）

### 制約・注意事項
- node_modules/ と .git/ ディレクトリを除外
- テストファイルとモックファイルは別途記載
- 本番用とテスト用を区別

### コンテキスト
このプロジェクトはNode.jsベースのWebアプリケーションです。
RESTful APIを提供していると想定されます。
"""
)
```

### 例2: 実装タスク（general-purposeタイプ）

```python
# Taskツールの呼び出し
Task(
  description="ユーティリティ関数作成",
  subagent_type="general-purpose",
  prompt=f"""
{generic_subagent_prompt_content}

---

## タスク記述

### タスク概要
配列操作ユーティリティ関数の実装

### 目的
配列を指定サイズのチャンクに分割する汎用的なユーティリティ関数を作成してください。

### 手順
1. src/utils/ディレクトリの存在を確認
2. arrayUtils.tsファイルを確認（存在すれば読み取り、なければ新規作成）
3. chunk関数を実装
4. TypeScriptのジェネリック型を使用して型安全性を確保
5. JSDocコメントを追加
6. エッジケースを処理（空配列、チャンクサイズ0等）
7. 使用例をコメントで追加

### 期待される成果物
- 実装されたファイルの完全パス
- 関数の型シグネチャ
- 簡単な使用例
- テストすべきエッジケースのリスト

### 制約・注意事項
- TypeScriptで実装
- 既存のコーディング規約に従う（ESLint設定を確認）
- 外部ライブラリは使用しない（標準APIのみ）
- 関数は純粋関数として実装（副作用なし）

### コンテキスト
このプロジェクトではTypeScript 5.x を使用しています。
既存のユーティリティ関数のパターンに従ってください。
"""
)
```

### 例3: Web調査タスク（general-purposeタイプ）

```python
# Taskツールの呼び出し
Task(
  description="React 19新機能調査",
  subagent_type="general-purpose",
  prompt=f"""
{generic_subagent_prompt_content}

---

## タスク記述

### タスク概要
React 19の新機能と変更点の包括的調査

### 目的
React 19の新機能、ブレイキングチェンジ、移行方法を調査し、
このプロジェクトへの適用可能性を評価してください。

### 手順
1. React 19の公式ドキュメントをWebSearchで検索
2. 主要な新機能をリストアップ
3. 各機能の詳細と利点を調査
4. ブレイキングチェンジを確認
5. package.jsonを確認して現在のReactバージョンを特定
6. プロジェクトへの影響を評価
7. 移行手順の概要を作成

### 期待される成果物
- 新機能リスト（各機能の簡潔な説明付き）
- ブレイキングチェンジの一覧
- 現在のプロジェクトへの影響評価
- 移行の優先順位と推奨事項
- 参照した情報源のURL

### 制約・注意事項
- 公式ドキュメントまたは信頼できる技術ブログのみを参照
- 実験的機能は明示的に区別して記載
- 情報の日付を確認（最新情報を優先）

### コンテキスト
現在のプロジェクトはReact 18を使用しています。
段階的な移行を検討しており、破壊的変更の影響を最小限に抑えたいです。
"""
)
```

### 例4: 分析タスク（Exploreタイプ）

```python
# Taskツールの呼び出し
Task(
  description="パフォーマンス問題検出",
  subagent_type="Explore",
  prompt=f"""
{generic_subagent_prompt_content}

---

## タスク記述

### タスク概要
Reactコンポーネントのパフォーマンス問題の検出と分析

### 目的
プロジェクト内のReactコンポーネントにおける潜在的なパフォーマンス問題を特定し、
優先順位付けして報告してください。

### 手順
1. src/components/ および src/pages/ ディレクトリのReactコンポーネントを検索
2. 以下のパターンを検索:
   - 大きなコンポーネント（200行以上）
   - useEffectの依存配列の問題
   - 不要な再レンダリングの原因
   - メモ化（useMemo, useCallback, React.memo）の未使用
   - インライン関数定義
   - 大量のデータを扱うコンポーネント
3. 各問題の深刻度を評価（高/中/低）
4. 具体的な修正方法を提案

### 期待される成果物
- 潜在的なパフォーマンス問題のリスト（深刻度別）
- 各問題の具体的な場所（ファイルパス:行番号）
- 問題の説明と影響
- 具体的な修正方法の推奨
- 修正の優先順位

### 制約・注意事項
- node_modules/ を除外
- テストファイルは参考程度に（本番コードを優先）
- 誤検出の可能性がある場合は明記

### コンテキスト
このプロジェクトはReactとTypeScriptを使用したSPAです。
最近パフォーマンスの低下が報告されており、原因を特定したいです。
"""
)
```

## タスク記述のベストプラクティス

### ✅ 良いタスク記述

1. **具体的で明確**:
   - 「エンドポイントを調べて」ではなく「APIエンドポイントの定義場所、使用フレームワーク、パターンを特定して」

2. **期待される成果物が明確**:
   - 「結果を教えて」ではなく「ファイルパス、行番号、具体例3-5個を含むリストを作成」

3. **制約が明示的**:
   - 除外すべきディレクトリ、ファイルタイプを明記
   - 特別な考慮事項を記載

4. **コンテキストが豊富**:
   - プロジェクトの背景情報
   - 技術スタック
   - 目的や意図

### ❌ 悪いタスク記述

1. **曖昧**:
   - 「コードを確認して」
   - 「問題を見つけて」

2. **期待が不明確**:
   - 「調査して」（何をどう報告するか不明）

3. **制約なし**:
   - どこを調査すべきか不明
   - 何を除外すべきか不明

4. **コンテキスト不足**:
   - なぜこのタスクが必要か不明
   - プロジェクトの状況が不明

## サブエージェントタイプの選択ガイド

### Exploreタイプを選択する場合

- **読み取り専用**のタスク
- ファイル・コード検索
- パターン分析
- 情報収集
- **高速実行**が必要

利用可能ツール: Glob, Grep, Read, Bash

### general-purposeタイプを選択する場合

- **ファイルの作成・編集**が必要
- **Web調査**（WebSearch, WebFetch）が必要
- 複雑なマルチステップタスク
- 包括的な実装タスク

利用可能ツール: すべて（Read, Write, Edit, Bash, Glob, Grep, WebSearch, WebFetch等）

## 注意事項

1. **generic-subagent-prompt.mdの内容を含める**:
   - サブエージェントが自律的に動作するために必要

2. **タスク記述は詳細に**:
   - サブエージェントは追加質問できない
   - すべての必要情報を含める

3. **期待する報告形式を明示**:
   - どのような形式で結果が欲しいか具体的に指定

4. **制約を明確に**:
   - 除外すべきもの、注意事項を明記
