---
name: skill-optimizer
description: スキルの重複検出、統合、分割を行い、スキルリポジトリを最適化する。既存スキルの分析、重複の特定、統合・分割の提案、品質チェックを実施したい場合に使用。
---

# スキル最適化ツール

このスキルは、スキルリポジトリの管理と最適化を支援します。重複の検出、スキルの統合・分割提案、品質チェックを提供し、スキルリポジトリを効率的に保ちます。

## 目的

このスキルは以下を提供します：

1. **重複検出** - 類似または重複した機能を持つスキルを自動的に発見
2. **統合提案** - 重複スキルを効率的に統合する方法を提案
3. **分割提案** - 大きすぎる、または複数の責任を持つスキルを適切に分割
4. **品質チェック** - スキルの構造、ドキュメント、命名規則の検証
5. **最適化推奨** - リポジトリ全体の構造改善の提案

## いつ使用するか

以下の場合にこのスキルを使用：

- スキルリポジトリに重複が存在する疑いがある
- 多数のスキルが追加され、整理が必要
- スキルの品質や一貫性を確保したい
- スキルの統合または分割の判断が必要
- リポジトリ全体の構造を最適化したい

## 使用方法

### ステップ1: スキル分析の実行

まず、分析対象のスキルまたはカテゴリを特定：

1. リポジトリ全体を分析する場合、すべてのSKILL.mdファイルを収集
2. 特定のカテゴリを分析する場合、そのカテゴリのスキルのみを対象

`scripts/analyze_skills.py`を使用してスキルを分析：

```bash
python3 scripts/analyze_skills.py <path-to-skills-directory>
```

このスクリプトは以下を実行：

- すべてのSKILL.mdファイルを読み取り
- name、description、内容を抽出
- 類似度を計算して重複を検出
- 分析レポートを生成

### ステップ2: 重複の特定

分析結果から以下をチェック：

1. **高い類似度** - 説明や目的が類似しているスキル（類似度>70%）
2. **機能の重複** - 同じタスクを異なる方法で実行するスキル
3. **カテゴリの誤配置** - 異なるカテゴリに配置された関連スキル

重複タイプの分類：

- **完全重複**: ほぼ同一の機能を提供（統合推奨）
- **部分重複**: 一部の機能が重複（統合または機能分離）
- **補完的**: 関連しているが異なる側面をカバー（クロスリファレンス推奨）

### ステップ3: 統合提案の作成

重複スキルを統合する際の手順：

1. **統合候補の評価**:
   - どちらのスキルがより包括的か
   - どちらがより良いドキュメントを持つか
   - どちらがより多く使用されているか（ファイルサイズ、参照数で推定）

2. **統合戦略の決定**:
   - **吸収**: 小さいスキルを大きいスキルに統合
   - **マージ**: 両方のベスト部分を組み合わせて新しいスキルを作成
   - **階層化**: 汎用スキルと専門スキルに分割

3. **統合計画の作成**:
   - マージするコンテンツを特定
   - 新しいSKILL.mdの構造を設計
   - バンドルリソースの統合方法を決定
   - 移行パスを文書化

### ステップ4: 分割提案の作成

大きすぎるスキルを分割する際の手順：

1. **分割候補の特定**:
   - SKILL.mdが非常に長い（>5000語）
   - 複数の独立した責任を持つ
   - 異なるユースケースが混在

2. **分割ポイントの決定**:
   - 機能的に独立したセクションを特定
   - 各セクションが独立したスキルとして成立するか確認
   - バンドルリソースの分割方法を検討

3. **分割計画の作成**:
   - 新しいスキル名を提案
   - 各スキルの責任範囲を定義
   - リソースの分配を計画
   - クロスリファレンスを設計

### ステップ5: 品質チェックの実行

`scripts/check_quality.py`を使用してスキルの品質を検証：

```bash
python3 scripts/check_quality.py <path-to-skills-directory>
```

チェック項目：

1. **構造の検証**:
   - YAMLフロントマターの存在と形式
   - 必須フィールド（name、description）の確認
   - ディレクトリ構造の標準への準拠

2. **ドキュメントの品質**:
   - 説明の明確性と具体性
   - 手順の完全性
   - 例の存在

3. **命名規則**:
   - スキル名の一貫性
   - ディレクトリ名とスキル名の一致
   - 適切なケバブケースの使用

4. **参照の整合性**:
   - SKILL.md内で参照されるファイルの存在
   - バンドルリソースの適切な配置

### ステップ6: 最適化推奨の生成

全体分析に基づいて推奨事項を作成：

1. **カテゴリ構造の改善**:
   - 新しいカテゴリの提案
   - スキルの再配置
   - カテゴリ階層の最適化

2. **README更新**:
   - カテゴリREADMEに新しいスキルを追加
   - スキルマップの更新
   - ラーニングパスの調整

3. **依存関係の可視化**:
   - スキル間の参照関係を特定
   - クロスリファレンスの改善提案

### ステップ7: 実装と検証

最適化を実装する際：

1. **変更の優先順位付け**:
   - 影響度の高い変更から実施
   - 低リスクの変更を先行

2. **段階的な実装**:
   - 一度に1つの統合/分割を実行
   - 各変更後にテスト

3. **ドキュメントの更新**:
   - READMEファイルを更新
   - クロスリファレンスを追加
   - 変更ログを記録

4. **検証**:
   - リンターを実行（markdownlint、yamllint）
   - 構造検証スクリプトを実行
   - 手動レビュー

## 出力形式

分析と推奨事項は以下の形式で提供：

### 重複分析レポート

```markdown
## 重複分析レポート

### 完全重複（統合推奨）

- **スキルA** と **スキルB**
  - 類似度: 85%
  - 理由: [説明]
  - 推奨: スキルAにスキルBを統合

### 部分重複（要検討）

- **スキルC** と **スキルD**
  - 類似度: 60%
  - 重複部分: [説明]
  - 推奨: [提案]
```

### 品質チェックレポート

```markdown
## 品質チェックレポート

### エラー

- スキルE: YAMLフロントマター不正
- スキルF: 必須フィールドが欠落

### 警告

- スキルG: 説明が短すぎる（<50語）
- スキルH: 例が不足

### 推奨

- スキルI: SKILL.mdが長すぎる（分割を検討）
```

## ベストプラクティス

1. **慎重な判断**: 統合/分割の決定前に十分な分析を実施
2. **ユーザー影響の考慮**: 既存ユーザーへの影響を最小化
3. **段階的な変更**: 大規模な変更は段階的に実施
4. **ドキュメント重視**: すべての変更を適切に文書化
5. **テストの徹底**: 変更後の検証を怠らない

## 注意事項

- 自動分析は完璧ではなく、最終判断は人間が行う
- スキルの使用頻度や重要度も考慮する
- 変更前にバックアップを取る
- 大規模な変更は段階的に実施する
